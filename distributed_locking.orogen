name "distributed_locking"

using_library "distributed_locking"
using_library "fipa_acl"

import_types_from "fipa_acl/message_generator/serialized_letter.h"
import_types_from "distributed_locking/DLM.hpp"
import_types_from "distributed_locking/Agent.hpp"
import_types_from "base"

task_context "DistributedLockingTask" do
    output_port("lettersOut", "/fipa/SerializedLetter").
        doc("Output port for FIPA letters, that will be sent by the MTS")
    input_port("lettersIn", "/fipa/SerializedLetter").
        doc("Input port for FIPA letters from the MTS")
    port_driven ("lettersIn")
    
    
    # why isn't list accepted as container type!?
    operation("lock").
        argument("resource", "/std/string/", "the name of the resource").
        argument("agents", "/std/vector</fipa/Agent >", "the agents to communicate with for this lock").
        doc("Tries to lock the resource. isLocked has to be called subsequently to check the status.")
    
    operation("unlock").
        argument("resource", "/std/string/", "the name of the resource").
        doc("Unlocks the resource.")
        
    operation("getLockState").
        returns("/fipa/distributed_locking/lock_state/LockState").
        argument("resource", "/std/string/", "the name of the resource").
        doc("Gets the lock state for the given resource.")
end